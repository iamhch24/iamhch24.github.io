---
title: "[DB] MySQL"
categories:
    - dev
tags:
    - dev
    - db
toc: true

---

# DB

### 0 사용대상
* 디비는 연결과 관리만 하고
* 결국 사용자가 사용하는 것은 테이블임

### 1 권한
* Connect 권한 :: 접근 connect 권한, 세션권한
* Resource 권한 :: 리소스 생성, 수정, 삭제 할 수 있는 권한
* Admin 권한 :: 관리자 권한

### 2 설치 
* https://dev.mysql.com/downloads/file/?id=474803
밑에 No thanks, just start my download. 클릭하면 다운로드 실행됨

* 설치과정은 아래 자바대장 블로그 참고
https://blog.naver.com/dgkim1007/221230144969

### 3 환경변수 설정
* 내컴퓨터 > 고급 > 시스템 변수 
* MySQL_HOME :: C:\Program Files\MySQL\MySQL Server 5.7\bin
* Path :: %MySQL_HOME%; ~~

### 4 mysql 실행
* cmd에서 mysql -u root -p 를 실행하면
* 암호 입력하는 프롬프트 나오고 암호 입력하면 들어감.

### 5 show databases; // 가지고 있는 데이터베이스 전체를 보여준다

### 6 use mysql; // mysql db를 선택함.
mysql :: db에서 권한 설정 등을 관리하는 db

### 7 show tables; // DB안에 있는 테이블을 보여줌

### 8 select host, user from user; // user 테이블에서 host, user 조회
localhost : mysql.session / mysql.sys / root

### 9 create database aiappdb; // DB 생성
use aiappdb; // aiappdb 선택

### 10 select database(); // 현재 사용하고 있는 db를 보여줌

### 11 데이터 타입
* varchar 2 -- 오라클만 사용
* varchar --  다른 db에서 사용, 들어온 만큼만 확보함
* char -- 정해진 자리를 차지함 (고정길이) --> 검색 속도가 빠름
* tiny
* int (numer) -- 오라클에서 number / MySql에서는 int 타입 사용
* glub -- 이미지 저장
* date 

### 12 숫자 vs 문자 -- 저장하는 방식이 다름
* 숫자는 기억공간에서 뒤로 부터 저장하고
* 문자는 기억공간에서 앞에서부터 저장함
--> 숫자도 연산을 필요하지 않은 경우는 문자로 저장한다.

### 13 Primary key == 유일키
key :: primary, unique, foriegn (relation 맺을때, 제약을 걸 때), 

### 14 정규화 == 중복 칼럼을 제거함, 최소화
보조 테이블에서 입력할 때 주 테이블에 없는 데이터를 넣으면 안됨.
이때 관계를 맺음으로 제약을 걸어줌 (foreign 키로 제약을 설정함)

견적서 넣을 때 외래키를 넣지만
개발할 때는 외래키를 뺌 (데이터 넣기 어려움)
왠만한 것은 프로그램상  jQuery에서 해결함.

### 15 E-R Diagram 
-- 외래키가 설정되어야 연결됨

### 16 PK 
primary key를 가지는 것을 원칙
없는 경우 sequece index로 pk를 줌

PK 키 조건
너무 짧아도 안되고 길어도 안됨
아이디를 만들어 썻는데  
최근에는 id를 따로 안쓰고 email로 아이디 처리 함
또 pk키가 가능한 녀석은 후보키라고 함. -- unique로 설정가능
ex) 별칭 도 unique로 설정

pk와 unique 차이는 null 
unique는 null값을 가질 수 있음.

외래키 조건 :: 부모키는 유일한 값을 가지고 있어야 함.


### 17 member table 생성
```
create table member(
	email varchar(20) primary key,
	name varchar(20),
	password varchar(100),
	phone varchar(20),
	memlevel int(1),
	photo varchar(100) 
);
```

### 18 desc member; // 테이블 구조가 보임 -- > select 시 이 순서대로 출력됨 

### 19 select // 테이블 내용이 보임

### 20 alter table member // 테이블 칼럼 변경 add + drop + change + desc 조회
```
alter table member add age int(3) default 20;
alter table member drop primary key; //기본키 삭제
alter table member add primary key(email); // 기본키 추가
alter table member change name chname varchar(20); // 칼럼 변경
alter table member add unique key(name); // 유니크 키 선언
alter table member change name name varchar(20) not null; // not null 조건 추가
alter table member drop name;
alter table member add name varchar(20) after email; // 이메일 뒤어 넣어라
```

### 21 테이블 로(레코드) 추가 삭제 변경 조회  insert + delete + update + select
```
insert into member( 칼럼명 ...) valuse ( 값들...); // 필요한 것만 골라서, 갯수가 맞아야 함. -- 많이 사용
insert into member valuses ( 값들...); // 이 경우는 정의된 필드 값을 모두 넣어줘야 함.

insert into member (email,name) values ('aaa@a.com','김한국');
insert into member (email,name,age) values ('abc@a.com','김한국',25);
insert into member values ('bbb@b.com', 'Kar','111','photo00','3');
-- ERROR 1136 (21S01): Column count doesn't match value count at row 1
insert into member values ('bbb@b.com', 'Kar','111','photo00','3','images');
create table cpmember as select * from member; // 테이블 카피, 키는 카피 안됨. 내용과 구조만 파키됨
drop table cpmember;
create table cpmember as select email, name from member; // 테이블 부분 카피
insert into cpmember values ('aaa@a.com','박미국');
alter table cpmember add primary key(email); --> 중복 에러 뜸 
delete from cpmember where email = 'aaa@a.com';

```

### 22 제약조건 확인 
select * from  information_schema.table_constraints where table_name = '테이블이름';

### 23 완전무결성 / 위치투명성 
완전무결성 :: 결함이 있으면 db에 들어가지 않음, 조건에 충족해야 insert가능
위치 투명성 :: 어느 위치든지 사용자, pw, 드라이버만 맞으면 연결됨

### 24 한글 설정
-   `/etc/mysql/my.cnf`  파일 변경하기

현재 Character-Set 확인하기
-   `show variables like ‘c%’`
-   `status`

https://nesoy.github.io/articles/2017-05/mysql-UTF8


### 25 롤백이 없음








<!--stackedit_data:
eyJoaXN0b3J5IjpbMjA4Mzk3MDQ4OCw1OTU4MTg3ODAsODM2OT
k4MjYsMjY3MDI2ODMyLDE5OTI3NDQwMTAsMjM1MDUyMTg0LC0x
ODQ1NzM3MDE5LDIxMDcxNTMwNywtNDQyNTI0OTQ4LC02MTc3OT
U3NjUsLTQwMTgzNTk4MCw0MDgyMDQ1OTgsMjAwNjQxMjkzLDgz
OTI0OTU5LDExNzYxNzQ4ODRdfQ==
-->